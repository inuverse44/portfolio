---
title: Quarkus(Kotlin)からNEONへ接続する
date: '2026-01-31'
category: 
tags:
  - Kotlin
cover: 
published: true
---


## はじめに
個人開発について漫然と考えていると、ふと社内でNEONという良さげなDBaaSの風の噂を盗み聞きしました。この記事では普段使っているKotlinとフレームワークQuarkusで、実際にNEONに接続するまでを追った記録です。

参考文献は

https://neon.com/docs/guides/quarkus-jdbc

https://ja.quarkus.io/guides/datasource

になります。基本的にはNEONの記事を追っています。

NEONとはPostgreSQLが使えるクラウドサービスで
- [無料枠](https://neon.com/pricing)
- [ブランチ機能](https://neon.com/branching)

が特徴です。詳しくは他の記事を参考にしてみてください[^1][^2]。


本記事の構成は


- [サインアップしてプロジェクトを作成する](#サインアップしてプロジェクトを作成する)
- [ダッシュボードからDBへの接続情報を取得する](#ダッシュボードからdbへの接続情報を取得する)
- [Quarkusを立ち上げる](#quarkusを立ち上げる)
- [application.propertiesに設定を施す](#applicationpropertiesに設定を施す)
- [接続確認する](#接続確認する)

となっております。


---


## サインアップしてプロジェクトを作成する

私はGoogleアカウントでログインしました。

https://neon.com

![スクリーンショット 2026-01-30 0.52.33.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3862501/b1619190-d49d-420b-a8d1-28fb47c237ac.png)

プロジェクトを作成する画面が出現すると思いますが、特に設定することなく進めています。

## ダッシュボードからDBへの接続情報を取得する

ダッシュボードに接続するための情報が得られる*Connection string*にアクセスしましょう。

![neon-connection-string-in-dashboard.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3862501/eed355a0-5a32-4d5c-b01f-ef1359d565e6.png)

すると

![neon-connection-string-contents.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3862501/14e52d94-7661-4045-80a9-287eb71e73f6.png)

という画面が得られます。赤い四角で隠している部分が接続先のDBの設定です。
後ほど、コンフィグファイルの設定に使うので控えておきましょう。

ちなみにconnection stringについてpsql以下はそれぞれ
```
postgresql://[ユーザ名] : [パスワード]　@ [ホスト名]　/ [データベース名]　? [接続オプション]
```
に対応しています（可視性のため、空白を多めに入れております）。



## Quarkusを立ち上げる

基本的には公式に倣いますが、本記事においてJavaではなくKotlinを使用するため、Quarkusの作成コマンドには気をつけておきます。`kotlin` extension と`--gradle-kotlin-dsl`オプションに注意してください。

```quarkus
quarkus create app neon-with-quarkus-jdbc \
  --name neon-with-quarkus-jdbc \
  --package-name com.neon.tech \
  --extensions kotlin,jdbc-postgresql,quarkus-agroal,resteasy-reactive \
  --gradle-kotlin-dsl
```

https://ja.quarkus.io/guides/kotlin


## `application.properties`に設定を施す

`src/main/resources/`の中に`application.properties`という設定ファイルがあります。

先ほどConnection stringで取得した情報を、ここで設定します（[参照記事](https://ja.quarkus.io/guides/datasource)）。
```
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=<username>
quarkus.datasource.password=<password>
quarkus.datasource.jdbc.url=<url>
```

## PostgreSQL JDBC Driverを使う

あとは`src/main/kotlin`にある`com.neon.tech`パッケージの中で`PostgresResource.kt`を作成します。中身は下記のようにしてみてください。

```kotlin
package com.neon.tech

import javax.sql.DataSource
import jakarta.ws.rs.GET
import jakarta.ws.rs.Path
import jakarta.ws.rs.Produces
import jakarta.ws.rs.core.MediaType

@Path("/postgres")
class PostgresResource(
    private val dataSource: DataSource
) {
    @GET
    @Path("/version")
    @Produces(MediaType.TEXT_PLAIN)
    fun getVersion(): String {
        return dataSource.connection.use { conn ->
            val metaData = conn.metaData
            "${metaData.databaseProductName} ${metaData.databaseProductVersion}"
        }
    }
}
```

ここまで来ればほぼ終わりです。

## 接続確認する

`./gradlew quarkusDev`コマンドでプロジェクトを実行しましょう。

![スクリーンショット 2026-01-30 1.30.52.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3862501/43643dbb-0229-4e19-940c-76fb4191dff8.png)

localhostがポート8080でリッスンしているので、ここへ`curl http://localhost:8080/postgres/version`とリクエストします。すると`PostgreSQL 17.7 (bdd1736)%`のようなレスポンスが返ってきます。これにて接続の確認が完了です。



[^1]: https://micro-exits.dev/blog/019550f7-9413-753e-8cab-822d1c6aadad
[^2]: https://qiita.com/nuko-suke/items/e940ff8ccde35d09f668








