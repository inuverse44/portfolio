# Portfolio Repository Context (AGENTS.md)

This document provides a high-level overview of the repository's structure, features, and operational procedures to assist both AI and human contributors.

## ğŸš€ Core Features & Technology Stack
- **Framework**: Next.js (Pages Router) + TypeScript.
- **Styling**: Vanilla CSS Modules (no TailwindCSS as per user preference).
- **Blog Engine**: Markdown-based file system routing.
  - Features: Tags with counts, Sidebar layout (desktop), Responsive design.
- **SEO & Social**: Enhanced OGP tags, automated sitemap generation, and `robots.txt`.
- **Deployment**: Deployed to Firebase Hosting (SSG).

## ğŸ“‚ Directory Structure
```text
.
â”œâ”€â”€ .github/workflows/      # CI/CD pipelines (GitHub Actions)
â”œâ”€â”€ posts/                  # Blog post content (.md files)
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ images/posts/       # Blog assets (Directly managed, best practice)
â”‚   â”œâ”€â”€ favicon.png         # Site favicon
â”‚   â”œâ”€â”€ robots.txt          # Search engine instructions
â”‚   â””â”€â”€ sitemap.xml         # Generated by scripts/generate-sitemap.mjs
â”œâ”€â”€ scripts/                # Utility scripts (e.g., sitemap generator)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # Atomic Design inspired structure
â”‚   â”‚   â”œâ”€â”€ atoms/          # Smallest units (Meta, Tag, Button)
â”‚   â”‚   â”œâ”€â”€ molecules/      # Groups of atoms (Navigation, PostCard, TagList)
â”‚   â”‚   â””â”€â”€ organisms/      # Complex components (Header, Footer, PostBody)
â”‚   â”œâ”€â”€ constants/          # Site-wide configuration (URLs, Titles)
â”‚   â”œâ”€â”€ lib/                # Shared business logic
â”‚   â”‚   â””â”€â”€ posts/          # Markdown parsing, data fetching API
â”‚   â”œâ”€â”€ pages/              # Next.js routes
â”‚   â”‚   â”œâ”€â”€ blog.tsx        # Post list with tags and sidebar
â”‚   â”‚   â”œâ”€â”€ about.tsx       # Author profile
â”‚   â”‚   â””â”€â”€ external.tsx    # Recommended links
â”‚   â””â”€â”€ styles/             # Global CSS and CSS Modules
â”œâ”€â”€ package.json            # Scripts and dependencies
â””â”€â”€ next.config.js          # Next.js configuration
```

## ğŸ§ª Testing and Quality
- **Test Runner**: Vitest.
- **Methodology**: 
  - **Unit Testing**: Focused on data fetching logic (`src/lib/posts/api.ts`) and individual UI components.
  - **Component Testing**: Uses `@testing-library/react` and JSDOM to simulate user interactions.
- **Verification Commands**:
  - `npm run test`: Runs all tests once.
  - `npm run test:watch`: Runs tests in watch mode for development.
  - `npm run test -- --coverage`: Generates a coverage report in the `coverage/` directory.
- **Coverage Status**: 
  - Business logic (`src/lib/posts/api.ts`) aiming for high coverage.
  - Interactive components (Navigation, TagList) are verified for basic rendering and linking.
- **CI Enforcement**: GitHub Actions (`ci.yml`) automatically runs linting and tests on every PR and push.
- **Coding Guidelines**: Detailed rules are documented in [CODING_GUIDELINES.md](./CODING_GUIDELINES.md).

## ğŸ›  Operation & Deployment
- **Branching Strategy**: 
  - `develop`: Main development branch. All tasks start here.
  - `main`: Deployment target. Merged from `develop` after verification.
- **Workflow**:
  1. Make changes in `develop`.
  2. Run `npm run lint`, `npm run test`, and `npm run build` locally.
  3. Push to `develop` and verify CI status.
  4. Merge `develop` into `main` to trigger production deployment.
- **Build Process**:
  - `npm run build` performs `next build` followed by `node scripts/generate-sitemap.mjs`.
- **Deployment**:
  - Automated via GitHub Actions (`deploy-firebase.yml`) to Firebase Hosting.
  - Uses `next build` (static export).

## ğŸ“ Best Practices (Current)
- **Asset Management**: Place blog images in `public/images/posts/[post-slug]/` and use absolute paths in Markdown (e.g., `/images/posts/[slug]/image.png`).
- **SEO**: Every page should use the `Meta` component with appropriate title/description. Post pages should set `type="article"`.
- **UI/Layout**: Individual pages can toggle a wider layout for sidebars by setting `Page.wide = true`.
- **Documentation**: Use `walkthrough.md` to track major changes and `AGENTS.md` (this file) for structural context.
